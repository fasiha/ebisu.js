var R=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var G=R((se,j)=>{"use strict";var S=2/(1+Math.sqrt(5));j.exports=U;function U(n,e,r,t,m,i){for(var a,o,l=0,u=r-S*(r-e),f=e+S*(r-e),c=n(u),s=n(f),d=n(e),x=n(r),h=e,M=r;++l<m&&Math.abs(r-e)>t;)s>c?(r=f,f=u,s=c,u=r-S*(r-e),c=n(u)):(e=u,u=f,c=s,f=e+S*(r-e),s=n(f));return a=.5*(r+e),o=.5*(c+s),i&&(i.iterations=l,i.argmin=a,i.minimum=o,i.converged=!0),isNaN(s)||isNaN(c)||l===m?(i&&(i.converged=!1),NaN):d<o?h:x<o?M:a}});var J=R((de,V)=>{"use strict";V.exports=k;function k(n,e,r,t,m,i,a){var o,l,u,f,c,s,d;for(f=1,c=r,s=r,u=l=o=e(r);!d&&isFinite(t)&&!isNaN(t);)if(++f,d=!0,l<=u&&(u=l,c=Math.max(m,c-t),l=e(c),d=!1),o<=u&&(u=o,s=Math.min(i,s+t),o=e(s),d=!1),u=Math.min(u,l,o),(l===u&&c===m||o===u&&s===i)&&(d=!0),t*=f<4?2:Math.exp(f*.5),!isFinite(t))return n[0]=-1/0,n[1]=1/0,n;return n[0]=c,n[1]=s,n}});var Q=R((he,K)=>{"use strict";var ee=G(),ne=J(),I=[0,0];K.exports=function(e,r,t){r=r||{};var m,i=r.tolerance===void 0?1e-8:r.tolerance,a=r.initialIncrement===void 0?1:r.initialIncrement,o=r.lowerBound===void 0?-1/0:r.lowerBound,l=r.upperBound===void 0?1/0:r.upperBound,u=r.maxIterations===void 0?100:r.maxIterations;if(t&&(t.iterations=0,t.argmin=NaN,t.minimum=1/0,t.converged=!1),isFinite(l)&&isFinite(o))I[0]=o,I[1]=l;else if(r.guess===void 0?o>-1/0?m=l<1/0?.5*(o+l):o:m=l<1/0?l:0:m=r.guess,ne(I,e,m,a,o,l,u),isNaN(I[0])||isNaN(I[1]))return NaN;return ee(e,I[0],I[1],i,u,t)}});var Z=R((be,T)=>{var W=7,X=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23],re=607/128,O=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function Y(n){if(n<0)return Number("0/0");for(var e=O[0],r=O.length-1;r>0;--r)e+=O[r]/(n+r);var t=n+re+.5;return .5*Math.log(2*Math.PI)+(n+.5)*Math.log(t)-t+Math.log(e)-Math.log(n)}T.exports=function n(e){if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*n(1-e));if(e>100)return Math.exp(Y(e));e-=1;for(var r=X[0],t=1;t<W+2;t++)r+=X[t]/(e+t);var m=e+W+.5;return Math.sqrt(2*Math.PI)*Math.pow(m,e+.5)*Math.exp(-m)*r};T.exports.log=Y});var H=Q();var P=Z(),q=P.log;var te=Math.exp,oe=Math.log,ie=Math.sign,ae=Math.max;function $(n,e){let r=ae(...n),t=0;for(let a=n.length-1;a>=0;a--)t+=e[a]*te(n[a]-r);let m=ie(t);return t*=m,[oe(t)+r,m]}var z=new Map;function A(n){let e=z.get(n);return e!==void 0||(e=q(n),z.set(n,e)),e}function ue(n,e,r){return q(n)-q(n+r)+A(e+r)-A(e)}var w=(n,e)=>A(n)+A(e)-A(n+e),E=(n,e)=>P(n)*P(e)/P(n+e);function me(n,e){return-w(1+n-e,1+e)-Math.log(n+1)}function Ie(n){let e={betaln:w,betafn:E};return n.betaln&&(w=n.betaln),n.betafn&&(E=n.betafn),e}function L(n,e){var r=n*(1-n)/e-1,t=n*r,m=(1-n)*r;return[t,m]}function Ne(n,e,r=!1){let[t,m,i]=n,a=e/i,o=ue(t+a,t,m);return r?Math.exp(o):o}function Be(n,e,r,t,m,i=!0,a){if(0>e||e>r||r<1)throw new Error("0 <= successes and successes <= total and 1 <= total must be true");if(r===1)return le(n,e,t,m,i,a);if(!(e===Math.trunc(e)&&r===Math.trunc(r)))throw new Error("expecting integer successes and total");let[o,l,u]=n,f=t/u,c=r-e,s=[];for(let g=0;g<=c;g++)s.push(me(c,g));function d(g,p){let B=[];for(let b=0;b<=c;b++)B.push(s[b]+w(o+f*(e+b)+g*f*p,l));let F=[];for(let b=0;b<=c;b++)F.push(Math.pow(-1,b));return $(B,F)[0]}let x=d(0,0),h;if(i){let g=Math.log(.5),p=b=>d(1,b)-x-g,B={},F=H(b=>Math.abs(p(b)),{},B);if(!("converged"in B)||!B.converged)throw new Error("failed to converge");h=F,a=h*t}a||(a=u),h=a/t;let M=d(1,h)-x,N=Math.exp(M),C=Math.exp(d(2,h)-x);if(N<=0)throw new Error("negative mean encountered");if(C<=0)throw new Error("negative 2nd moment encountered");let D=Math.exp(2*M),y=C-D;if(y<=0)throw new Error("negative variance encountered");let[_,v]=L(N,y);return[_,v,a]}function le(n,e,r,t,m=!0,i){if(!(0<=e&&e<=1))throw new Error("expecting result between 0 and 1 inclusive");let[a,o,l]=n,u=e>.5,f=u?e:1-e;t===void 0&&(t=1-f);let c=r/l,[s,d]=u?[f-t,t]:[t-f,1-t],x=s*E(a+c,o)+d*(E(a,o)||0);function h(v,g){let p=s*E(a+c+v*c*g,o);return d!==0&&(p+=d*E(a+v*c*g,o)),p/x}let M;if(m){let v={},g=H(p=>Math.abs(h(1,p)-.5),{lowerBound:0},v);if(!("converged"in v)||!v.converged)throw new Error("failed to converge");M=g,i=M*r}else i||(i=l),M=i/r;let N=h(1,M),D=h(2,M)-N*N,[y,_]=L(N,D);if(y<=0||_<=0)throw new Error("newAlpha and newBeta must be greater than zero");return[y,_,i]}function Ee(n,e=4,r=e){return[e,r,n]}function ce(n,e=.5,r=1e-4){if(e<0||e>1)throw new Error("percentiles must be between (0, 1) exclusive");let[t,m,i]=n,a=w(t,m),o=Math.log(e);function l(c){let s=w(t+c,m)-a;return Math.abs(s-o)}let u={},f=H(l,{lowerBound:0,tolerance:r},u);if(!("converged"in u)||!u.converged)throw new Error("failed to converge");return f*i}function ye(n,e=1){let[r,t,m]=n,i=ce(n),a=i/m,o=w(r,t),l=w(r+2*a,t)-o,f=1/(8*Math.exp(l)-2)-.5;if(f<=0)throw new Error("non-positive alpha, beta encountered");return[f,f,i*e]}export{Ie as customizeMath,Ee as defaultModel,ce as modelToPercentileDecay,Ne as predictRecall,ye as rescaleHalflife,Be as updateRecall};
//# sourceMappingURL=ebisu.min.mjs.map
