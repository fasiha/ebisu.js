"use strict";var ebisu=(()=>{var q=Object.defineProperty;var te=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var ie=Object.prototype.hasOwnProperty;var O=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),ae=(n,e)=>{for(var r in e)q(n,r,{get:e[r],enumerable:!0})},ue=(n,e,r,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of oe(e))!ie.call(n,o)&&o!==r&&q(n,o,{get:()=>e[o],enumerable:!(t=te(e,o))||t.enumerable});return n};var me=n=>ue(q({},"__esModule",{value:!0}),n);var X=O((Pe,W)=>{"use strict";var T=2/(1+Math.sqrt(5));W.exports=le;function le(n,e,r,t,o,m){for(var a,i,u=0,f=r-T*(r-e),c=e+T*(r-e),s=n(f),l=n(c),d=n(e),g=n(r),B=e,p=r;++u<o&&Math.abs(r-e)>t;)l>s?(r=c,c=f,l=s,f=r-T*(r-e),s=n(f)):(e=f,f=c,s=l,c=e+T*(r-e),l=n(c));return a=.5*(r+e),i=.5*(s+l),m&&(m.iterations=u,m.argmin=a,m.minimum=i,m.converged=!0),isNaN(l)||isNaN(s)||u===o?(m&&(m.converged=!1),NaN):d<i?B:g<i?p:a}});var Z=O((Ae,Y)=>{"use strict";Y.exports=fe;function fe(n,e,r,t,o,m,a){var i,u,f,c,s,l,d;for(c=1,s=r,l=r,f=u=i=e(r);!d&&isFinite(t)&&!isNaN(t);)if(++c,d=!0,u<=f&&(f=u,s=Math.max(o,s-t),u=e(s),d=!1),i<=f&&(f=i,l=Math.min(m,l+t),i=e(l),d=!1),f=Math.min(f,u,i),(u===f&&s===o||i===f&&l===m)&&(d=!0),t*=c<4?2:Math.exp(c*.5),!isFinite(t))return n[0]=-1/0,n[1]=1/0,n;return n[0]=s,n[1]=l,n}});var $=O((Fe,_)=>{"use strict";var ce=X(),se=Z(),N=[0,0];_.exports=function(e,r,t){r=r||{};var o,m=r.tolerance===void 0?1e-8:r.tolerance,a=r.initialIncrement===void 0?1:r.initialIncrement,i=r.lowerBound===void 0?-1/0:r.lowerBound,u=r.upperBound===void 0?1/0:r.upperBound,f=r.maxIterations===void 0?100:r.maxIterations;if(t&&(t.iterations=0,t.argmin=NaN,t.minimum=1/0,t.converged=!1),isFinite(u)&&isFinite(i))N[0]=i,N[1]=u;else if(r.guess===void 0?i>-1/0?o=u<1/0?.5*(i+u):i:o=u<1/0?u:0:o=r.guess,se(N,e,o,a,i,u,f),isNaN(N[0])||isNaN(N[1]))return NaN;return ce(e,N[0],N[1],m,f,t)}});var k=O((Se,K)=>{var z=7,U=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23],he=607/128,J=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function L(n){if(n<0)return Number("0/0");for(var e=J[0],r=J.length-1;r>0;--r)e+=J[r]/(n+r);var t=n+he+.5;return .5*Math.log(2*Math.PI)+(n+.5)*Math.log(t)-t+Math.log(e)-Math.log(n)}K.exports=function n(e){if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*n(1-e));if(e>100)return Math.exp(L(e));e-=1;for(var r=U[0],t=1;t<z+2;t++)r+=U[t]/(e+t);var o=e+z+.5;return Math.sqrt(2*Math.PI)*Math.pow(o,e+.5)*Math.exp(-o)*r};K.exports.log=L});var Ee={};ae(Ee,{customizeMath:()=>we,defaultModel:()=>Be,modelToPercentileDecay:()=>re,predictRecall:()=>xe,rescaleHalflife:()=>Ne,updateRecall:()=>Ie});var S=$();var H=k(),E=H.log;var de=Math.exp,be=Math.log,Me=Math.sign,ge=Math.max;function j(n,e){let r=ge(...n),t=0;for(let a=n.length-1;a>=0;a--)t+=e[a]*de(n[a]-r);let o=Me(t);return t*=o,[be(t)+r,o]}var ee=new Map;function D(n){let e=ee.get(n);return e!==void 0||(e=E(n),ee.set(n,e)),e}function ve(n,e,r){return E(n)-E(n+r)+D(e+r)-D(e)}var I=(n,e)=>D(n)+D(e)-D(n+e),C=(n,e)=>E(n)+E(e)-E(n+e),A=(n,e)=>H(n)*H(e)/H(n+e);function pe(n,e){return-I(1+n-e,1+e)-Math.log(n+1)}function we(n){let e={betaln:I,betafn:A};return n.betaln&&(I=n.betaln),n.betafn&&(A=n.betafn),e}function ne(n,e){var r=n*(1-n)/e-1,t=n*r,o=(1-n)*r;return[t,o]}function xe(n,e,r=!1){let[t,o,m]=n,a=e/m,i=ve(t+a,t,o);return r?Math.exp(i):i}function Ie(n,e,r,t,o,m=!0,a,i){if(0>e||e>r||r<1)throw new Error("0 <= successes and successes <= total and 1 <= total must be true");if(r===1)return Q(n,e,t,o,m,a,i);if(!(e===Math.trunc(e)&&r===Math.trunc(r)))throw new Error("expecting integer successes and total");let[u,f,c]=n,s=t/c,l=r-e,d=[];for(let x=0;x<=l;x++)d.push(pe(l,x));function g(x,b){let h=[];for(let M=0;M<=l;M++)h.push(d[M]+I(u+s*(e+M)+x*s*b,f));let v=[];for(let M=0;M<=l;M++)v.push(Math.pow(-1,M));return j(h,v)[0]}let B=g(0,0),p;if(m){let x=Math.log(.5),b=M=>g(1,M)-B-x,h={},v=S(M=>Math.abs(b(M)),{},h);if(!("converged"in h)||!h.converged)throw new Error("failed to converge");p=v,a=p*t}a||(a=c),p=a/t;let y=g(1,p)-B,P=Math.exp(y),w=Math.exp(g(2,p)-B);if(P<=0)throw new Error("negative mean encountered");if(w<=0)throw new Error("negative 2nd moment encountered");let F=Math.exp(2*y),G=w-F;if(G<=0)throw new Error("negative variance encountered");let[V,R]=ne(P,G);return[V,R,a]}function Q(n,e,r,t,o=!0,m,a=!1){if(!(0<=e&&e<=1))throw new Error("expecting result between 0 and 1 inclusive");let[i,u,f]=n,c=e>.5,s=c?e:1-e;t===void 0&&(t=1-s);let l=r/f,[d,g]=c?[s-t,t]:[t-s,1-t],B=d*A(i+l,u)+g*(A(i,u)||0),p=a?j([C(i+l,u),C(i,u)||-1/0],[d,g])[0]:0;function y(b,h){let v=d*A(i+l+b*l*h,u);return g!==0&&(v+=g*A(i+b*l*h,u)),v/B}function P(b,h){return g!==0?j([C(i+l+b*l*h,u),C(i+b*l*h,u)],[d,g])[0]-p:Math.log(d)+C(i+l+b*l*h,u)-p}let w;if(o){let b={},h;if(a){let v=Math.log(.5);h=S(M=>Math.abs(P(1,M)-v),{lowerBound:0},b)}else h=S(v=>Math.abs(y(1,v)-.5),{lowerBound:0},b);if(!("converged"in b)||!b.converged){if(!a)return Q(n,e,r,t,o,m,!a);throw console.error(b,{prior:n,result:e,tnow:r,q0:t,rebalance:o,tback:m}),new Error("failed to converge")}w=h,m=w*r}else m||(m=f),w=m/r;let F=a?Math.exp(P(1,w)):y(1,w),V=(a?Math.exp(P(2,w)):y(2,w))-F*F,[R,x]=ne(F,V);if(!(R>0&&x>0&&isFinite(R)&&isFinite(x))){if(!a)return Q(n,e,r,t,o,m,!a);throw new Error("newAlpha and newBeta must be finite and greater than zero")}return[R,x,m]}function Be(n,e=4,r=e){return[e,r,n]}function re(n,e=.5,r=1e-4){if(e<0||e>1)throw new Error("percentiles must be between (0, 1) exclusive");let[t,o,m]=n,a=I(t,o),i=Math.log(e);function u(s){let l=I(t+s,o)-a;return Math.abs(l-i)}let f={},c=S(u,{lowerBound:0,tolerance:r},f);if(!("converged"in f)||!f.converged)throw new Error("failed to converge");return c*m}function Ne(n,e=1){let[r,t,o]=n,m=re(n),a=m/o,i=I(r,t),u=I(r+2*a,t)-i,c=1/(8*Math.exp(u)-2)-.5;if(c<=0)throw new Error("non-positive alpha, beta encountered");return[c,c,m*e]}return me(Ee);})();
//# sourceMappingURL=ebisu.min.js.map
